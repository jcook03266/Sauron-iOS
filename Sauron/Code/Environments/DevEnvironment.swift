//
//  DevEnvironment.swift
//  Sauron
//
//  Created by Justin Cook on 12/28/22.
//

import Foundation
import Combine

class DevEnvironment: Environment {
    typealias EnvironmentType = DevEnvironment
    
    // MARK: - Instance variables for this environment
    let id: UUID = UUID()
    let scope: EnvironmentScopes = .dev
    static let shared: DevEnvironment = .init()
    
    // MARK: - Protocol Conformance
    static func == (lhs: DevEnvironment,
                    rhs: DevEnvironment) -> Bool {
        let condition = lhs.id == rhs.id
        && lhs.scope == rhs.scope
        
        return condition
    }
    
    func hash(into hasher: inout Hasher) {
        hasher.combine(id)
    }
    
    /// Coin Model JSON Parsing Testing
    var testCoinModel: CoinModel!
    var testCoinModelArray: [CoinModel] = []
    
    /// Contains sample coin info for BTC and ETH in a 1D JSON array
    let testCoinModelJSONArray = """
    [
      {
        "id": "bitcoin",
        "symbol": "btc",
        "name": "Bitcoin",
        "image": "https://assets.coingecko.com/coins/images/1/large/bitcoin.png?1547033579",
        "current_price": 16780.89,
        "market_cap": 322889378620,
        "market_cap_rank": 1,
        "fully_diluted_valuation": 352342840826,
        "total_volume": 15634851777,
        "high_24h": 16961.42,
        "low_24h": 16766.15,
        "price_change_24h": -57.465607953748986,
        "price_change_percentage_24h": -0.34128,
        "market_cap_change_24h": -1303214050.3083496,
        "market_cap_change_percentage_24h": -0.40199,
        "circulating_supply": 19244543,
        "total_supply": 21000000,
        "max_supply": 21000000,
        "ath": 69045,
        "ath_change_percentage": -75.69909,
        "ath_date": "2021-11-10T14:24:11.849Z",
        "atl": 67.81,
        "atl_change_percentage": 24643.7736,
        "atl_date": "2013-07-06T00:00:00.000Z",
        "roi": null,
        "last_updated": "2022-12-27T17:08:30.024Z",
        "sparkline_in_7d": {
          "price": [
            16822.453320592955,
            16833.082475161387,
            16806.61005693587,
            16907.930115417104,
            16940.613225349385,
            16850.630350990254,
            16817.88741317133,
            16848.491172627306,
            16900.002254436284,
            16835.789216197187,
            16881.915322645258,
            16884.341762425352,
            16916.07097405973,
            16837.570834949827,
            16871.285431254757,
            16862.973290350612,
            16847.07876635647,
            16802.021209548384,
            16837.569996354712,
            16846.875005856884,
            16832.7001272578,
            16835.382940121242,
            16875.040552507027,
            16875.778537781127,
            16875.380533779946,
            16861.032779411573,
            16842.248783026116,
            16813.603009303803,
            16874.281197668133,
            16818.562105909084,
            16813.899488528754,
            16809.089229087327,
            16761.23557070878,
            16789.96178511021,
            16790.236409847126,
            16777.551794262235,
            16822.639889639624,
            16882.232875188733,
            16835.70572527119,
            16855.990440267098,
            16866.926143845125,
            16854.818234389553,
            16854.818234389553,
            16831.787085775686,
            16820.286809829617,
            16811.277312174938,
            16840.43298365396,
            16858.552061024122,
            16828.171401125797,
            16849.917168486674,
            16822.99838892954,
            16761.565646447092,
            16688.240957018716,
            16661.688999329024,
            16647.997243953723,
            16611.77055390211,
            16620.811703178,
            16656.8058694788,
            16764.61277070444,
            16793.457692361906,
            16800.94753254382,
            16830.385066529358,
            16805.669851902487,
            16801.840534391034,
            16833.63907737585,
            16837.403463396167,
            16833.613489346495,
            16825.495051828395,
            16848.459705360012,
            16854.60908380771,
            16845.20438680243,
            16844.71575084304,
            16866.737068741306,
            16846.444980105683,
            16878.58201355801,
            16891.297302185394,
            16800.389952291305,
            16843.324244213825,
            16833.5186389911,
            16854.460790677775,
            16845.20394128685,
            16857.05646176291,
            16829.569665685623,
            16825.560754591264,
            16802.19013067553,
            16791.45543916491,
            16828.5039057286,
            16818.886333963925,
            16828.80915767001,
            16849.1353436805,
            16844.63646922823,
            16826.94422938057,
            16830.32100715682,
            16859.602706687205,
            16838.84722581856,
            16843.698114347266,
            16833.179777617614,
            16826.127986844378,
            16835.60904589224,
            16826.52735073518,
            16840.053047104313,
            16844.75966886341,
            16846.46639955969,
            16846.743046196585,
            16849.228682191264,
            16853.84096165539,
            16848.57056951711,
            16838.55847898353,
            16847.802247651052,
            16848.649159225337,
            16849.932721831166,
            16848.512350420737,
            16836.58057734161,
            16842.511784308153,
            16837.250031512558,
            16835.01977126436,
            16837.930437518276,
            16831.66911474702,
            16841.3948238686,
            16839.084643107144,
            16834.494972743123,
            16833.460321328374,
            16832.79193114006,
            16814.494641690155,
            16781.822451943077,
            16821.199913544602,
            16820.32217610258,
            16807.414662482362,
            16794.108452870256,
            16769.85904421313,
            16772.940684988003,
            16820.196694166687,
            16813.158456662797,
            16842.72026144195,
            16843.359409890574,
            16852.772718398166,
            16883.023913256362,
            16895.732317171107,
            16882.371697632705,
            16862.501900560783,
            16853.824750006406,
            16845.9569876033,
            16843.843448135598,
            16848.912074255015,
            16859.749930767142,
            16865.679924348886,
            16862.520948313442,
            16840.16651774838,
            16836.402019038687,
            16818.749629565693,
            16841.011497434578,
            16841.16468121544,
            16823.19653988069,
            16846.539413040075,
            16844.521298565145,
            16839.48881574047,
            16843.692990272582,
            16895.753539841488,
            16869.94367902591,
            16869.681983132617,
            16889.298174537,
            16869.264589868446,
            16890.08282608721,
            16875.43904573174,
            16876.94990058372,
            16869.15484593176,
            16861.249964108203,
            16886.480841768516,
            16865.316599966118
          ]
        }
      },
      {
        "id": "ethereum",
        "symbol": "eth",
        "name": "Ethereum",
        "image": "https://assets.coingecko.com/coins/images/279/large/ethereum.png?1595348880",
        "current_price": 1210.99,
        "market_cap": 145903809274,
        "market_cap_rank": 2,
        "fully_diluted_valuation": 145903809274,
        "total_volume": 3997276182,
        "high_24h": 1231.01,
        "low_24h": 1209.5,
        "price_change_24h": -4.070136640038527,
        "price_change_percentage_24h": -0.33497,
        "market_cap_change_24h": -771595738.9602661,
        "market_cap_change_percentage_24h": -0.52606,
        "circulating_supply": 120525151.397411,
        "total_supply": 120525151.397411,
        "max_supply": null,
        "ath": 4878.26,
        "ath_change_percentage": -75.18325,
        "ath_date": "2021-11-10T14:24:19.604Z",
        "atl": 0.432979,
        "atl_change_percentage": 279503.88658,
        "atl_date": "2015-10-20T00:00:00.000Z",
        "roi": {
          "times": 95.49952163911533,
          "currency": "btc",
          "percentage": 9549.952163911534
        },
        "last_updated": "2022-12-27T17:08:38.892Z",
        "sparkline_in_7d": {
          "price": [
            1213.1819711129378,
            1214.6070816287363,
            1211.540234549542,
            1218.6190393880374,
            1219.4333367258498,
            1213.8457068023788,
            1211.959974644434,
            1215.8692449153575,
            1216.9141254235562,
            1212.1638078412561,
            1216.2002872896066,
            1216.9712883145846,
            1218.6206878905346,
            1209.3652196942742,
            1212.8628507659487,
            1211.4691653976056,
            1211.362518757394,
            1207.968830475182,
            1211.3697912904324,
            1212.5270220875432,
            1212.0160153011827,
            1214.0342705221606,
            1216.0105011472745,
            1217.2119954988132,
            1217.0603020458614,
            1214.7174614052433,
            1214.666965852105,
            1213.1934536645556,
            1216.5123415913745,
            1212.9437589861138,
            1211.3672629639318,
            1211.307603140883,
            1208.5548364367776,
            1210.6009924660113,
            1211.955439745048,
            1210.8103707840874,
            1213.3431612255224,
            1218.368344764107,
            1213.9818516941393,
            1215.19653652319,
            1215.6963168569712,
            1214.2400621825432,
            1214.2400621825432,
            1211.967463952965,
            1211.8842831447437,
            1212.8681797131758,
            1215.9806886578942,
            1218.8975581033621,
            1217.5193785721556,
            1218.6724908531437,
            1216.3152282175768,
            1209.8297911854052,
            1194.7416734471858,
            1187.9792780716036,
            1190.0086826008608,
            1188.5805118548922,
            1189.9857001089508,
            1194.67570103689,
            1215.969432910538,
            1215.0775429280116,
            1216.176108492704,
            1218.1279900847974,
            1216.6440578901093,
            1217.5775730959997,
            1223.3976586365013,
            1223.8156931638714,
            1222.786714313001,
            1221.7042778655116,
            1221.9359932507855,
            1222.4008893697226,
            1219.267388233679,
            1219.0547772693433,
            1224.819000400704,
            1222.985797737563,
            1225.106340843888,
            1224.055867892258,
            1216.0494527488497,
            1219.991664765364,
            1217.798139207985,
            1219.899456355594,
            1219.4027354008128,
            1220.5648093728494,
            1220.9094786155272,
            1222.2722048267133,
            1219.8005716650093,
            1220.701744919786,
            1221.0785128077857,
            1217.456622733294,
            1217.3934414500663,
            1219.1637837685873,
            1218.4079388832408,
            1217.0037117643797,
            1217.1847441786213,
            1220.6963021351066,
            1219.2472800692296,
            1219.0254400410336,
            1218.891822370751,
            1219.9189779382136,
            1219.3661275051095,
            1219.3570601307015,
            1219.7396014140888,
            1219.6632275954285,
            1219.8845177239095,
            1220.1686444625634,
            1221.9767594949076,
            1224.5326967462831,
            1222.8920212558676,
            1219.8194264685046,
            1220.3505374568178,
            1221.0825967667047,
            1221.940930765363,
            1222.4479723205332,
            1220.731568893723,
            1222.1190109552722,
            1220.566986093138,
            1218.9261189143306,
            1220.0893650485732,
            1220.3096719602545,
            1220.8230058013723,
            1221.8101179251373,
            1219.7476055301759,
            1218.8581621592339,
            1219.196441124349,
            1218.4020237280863,
            1209.6403174441193,
            1212.5105426260095,
            1212.586977339884,
            1210.5159247036665,
            1210.170522573819,
            1207.6484583867982,
            1206.1650906438888,
            1218.2900972027542,
            1217.2614128838457,
            1219.5089638236643,
            1219.2109580461045,
            1221.129692298342,
            1221.8337525129866,
            1221.1411867255308,
            1220.7495066083995,
            1220.3950952698763,
            1219.007002282334,
            1220.8832914971815,
            1219.8603856910747,
            1220.4854153385247,
            1220.166853686562,
            1220.5428275564511,
            1220.0846124999725,
            1215.9565321469156,
            1216.809995024314,
            1215.9829192622826,
            1217.2087742674362,
            1215.500373976211,
            1214.1536904199877,
            1217.7068428385548,
            1217.5644094392533,
            1217.3727064398465,
            1218.8144523194715,
            1226.026837956892,
            1224.4388175733054,
            1223.1868904317132,
            1225.3606814568634,
            1223.262956498339,
            1224.2294298395332,
            1223.278169795921,
            1223.4229993433225,
            1222.1155860225115,
            1218.0894507478833,
            1222.755346668305,
            1221.5313024849486
          ]
        }
      }]
    """
    
    /// Single JSON object containing info about BTC
    let testCoinModelJSON = """
{
        "id": "bitcoin",
        "symbol": "btc",
        "name": "Bitcoin",
        "image": "https://assets.coingecko.com/coins/images/1/large/bitcoin.png?1547033579",
        "current_price": 16780.89,
        "market_cap": 322889378620,
        "market_cap_rank": 1,
        "fully_diluted_valuation": 352342840826,
        "total_volume": 15634851777,
        "high_24h": 16961.42,
        "low_24h": 16766.15,
        "price_change_24h": -57.465607953748986,
        "price_change_percentage_24h": -0.34128,
        "market_cap_change_24h": -1303214050.3083496,
        "market_cap_change_percentage_24h": -0.40199,
        "circulating_supply": 19244543,
        "total_supply": 21000000,
        "max_supply": 21000000,
        "ath": 69045,
        "ath_change_percentage": -75.69909,
        "ath_date": "2021-11-10T14:24:11.849Z",
        "atl": 67.81,
        "atl_change_percentage": 24643.7736,
        "atl_date": "2013-07-06T00:00:00.000Z",
        "roi": null,
        "last_updated": "2022-12-27T17:08:30.024Z",
        "sparkline_in_7d": {
            "price": [
                16822.453320592955,
                16833.082475161387,
                16806.61005693587,
                16907.930115417104,
                16940.613225349385,
                16850.630350990254,
                16817.88741317133,
                16848.491172627306,
                16900.002254436284,
                16835.789216197187,
                16881.915322645258,
                16884.341762425352,
                16916.07097405973,
                16837.570834949827,
                16871.285431254757,
                16862.973290350612,
                16847.07876635647,
                16802.021209548384,
                16837.569996354712,
                16846.875005856884,
                16832.7001272578,
                16835.382940121242,
                16875.040552507027,
                16875.778537781127,
                16875.380533779946,
                16861.032779411573,
                16842.248783026116,
                16813.603009303803,
                16874.281197668133,
                16818.562105909084,
                16813.899488528754,
                16809.089229087327,
                16761.23557070878,
                16789.96178511021,
                16790.236409847126,
                16777.551794262235,
                16822.639889639624,
                16882.232875188733,
                16835.70572527119,
                16855.990440267098,
                16866.926143845125,
                16854.818234389553,
                16854.818234389553,
                16831.787085775686,
                16820.286809829617,
                16811.277312174938,
                16840.43298365396,
                16858.552061024122,
                16828.171401125797,
                16849.917168486674,
                16822.99838892954,
                16761.565646447092,
                16688.240957018716,
                16661.688999329024,
                16647.997243953723,
                16611.77055390211,
                16620.811703178,
                16656.8058694788,
                16764.61277070444,
                16793.457692361906,
                16800.94753254382,
                16830.385066529358,
                16805.669851902487,
                16801.840534391034,
                16833.63907737585,
                16837.403463396167,
                16833.613489346495,
                16825.495051828395,
                16848.459705360012,
                16854.60908380771,
                16845.20438680243,
                16844.71575084304,
                16866.737068741306,
                16846.444980105683,
                16878.58201355801,
                16891.297302185394,
                16800.389952291305,
                16843.324244213825,
                16833.5186389911,
                16854.460790677775,
                16845.20394128685,
                16857.05646176291,
                16829.569665685623,
                16825.560754591264,
                16802.19013067553,
                16791.45543916491,
                16828.5039057286,
                16818.886333963925,
                16828.80915767001,
                16849.1353436805,
                16844.63646922823,
                16826.94422938057,
                16830.32100715682,
                16859.602706687205,
                16838.84722581856,
                16843.698114347266,
                16833.179777617614,
                16826.127986844378,
                16835.60904589224,
                16826.52735073518,
                16840.053047104313,
                16844.75966886341,
                16846.46639955969,
                16846.743046196585,
                16849.228682191264,
                16853.84096165539,
                16848.57056951711,
                16838.55847898353,
                16847.802247651052,
                16848.649159225337,
                16849.932721831166,
                16848.512350420737,
                16836.58057734161,
                16842.511784308153,
                16837.250031512558,
                16835.01977126436,
                16837.930437518276,
                16831.66911474702,
                16841.3948238686,
                16839.084643107144,
                16834.494972743123,
                16833.460321328374,
                16832.79193114006,
                16814.494641690155,
                16781.822451943077,
                16821.199913544602,
                16820.32217610258,
                16807.414662482362,
                16794.108452870256,
                16769.85904421313,
                16772.940684988003,
                16820.196694166687,
                16813.158456662797,
                16842.72026144195,
                16843.359409890574,
                16852.772718398166,
                16883.023913256362,
                16895.732317171107,
                16882.371697632705,
                16862.501900560783,
                16853.824750006406,
                16845.9569876033,
                16843.843448135598,
                16848.912074255015,
                16859.749930767142,
                16865.679924348886,
                16862.520948313442,
                16840.16651774838,
                16836.402019038687,
                16818.749629565693,
                16841.011497434578,
                16841.16468121544,
                16823.19653988069,
                16846.539413040075,
                16844.521298565145,
                16839.48881574047,
                16843.692990272582,
                16895.753539841488,
                16869.94367902591,
                16869.681983132617,
                16889.298174537,
                16869.264589868446,
                16890.08282608721,
                16875.43904573174,
                16876.94990058372,
                16869.15484593176,
                16861.249964108203,
                16886.480841768516,
                16865.316599966118
            ]
        }}
"""
    
    func parseJSONIntoModel() {
        let jsonData = testCoinModelJSON.data(using: .utf8)

        testCoinModel = try! JSONDecoder().decode(CoinModel.self, from: jsonData ?? .init())

        let jsonDataArray = testCoinModelJSONArray.data(using: .utf8)
        testCoinModelArray = try! JSONDecoder().decode([CoinModel].self, from: jsonDataArray ?? .init())
        
        print(testCoinModelArray)
    }
    
    init() {}
}
    
